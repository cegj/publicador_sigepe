<style>
    body {
        font-family: Arial, Helvetica, sans-serif;
        max-width: 1000px;
        display: block;
        margin: 0 auto;
        background-color: rgb(253, 253, 244);
        padding: 20px;
        line-height: 1.5;
    }

    h1 {
        margin-top: 15px;
        text-align: center;
    }

    .chave, .chave-principal {
        display: inline-block;
        background-color: rgb(255, 218, 204);
        padding: 7px;
        margin: 3px;
        box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.1);
    }

    .chave-principal {
        margin-top: 20px;
        font-size: 1.2rem;
        background-color:rgb(255, 159, 121);
        color: rgb(100, 28, 0);
    }

    .instrucao-chave {
        display: block;
        margin: 3px;
        margin-left: 15px;
        padding: 7px;
        background-color: rgb(255, 243, 223);
    }

    .instrucao-chave > img {
        display: block;
        margin: 5px;
        margin-left: auto;
        margin-right: auto;
        border: 2px solid rgb(255, 232, 193);
    }

    code {
        font-size: 1rem;
        font-weight: bold;
        background-color: rgb(255, 248, 153);
        padding: 2px;
        font-family: monospace;
    }

    .chave-principal + p {
        color: #272727;
        margin-left: 15px;
    }

    .alerta {
        display: block;
        margin: 10px auto;
        padding: 15px;
        background-color: rgb(255, 215, 82);
        border-radius: 5px;
        min-width: min-content;
        max-width: 600px;
        color:rgb(65, 49, 0);
        font-size: 0.9rem;
    }

    .alerta::before{
        content:"⚠️";
    }

    .exemplo {
        color:rgba(0, 0, 0, 0.6);
        display: block;
        margin-top: 4px;
    }

    .exemplo::before {
        content: "Ex.: "
    }
</style>

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publicador de Portarias - v1.1.0</title>
</head>
<body>
    <h1>Publicador de Portarias v1.1.0</h1>
    <h2>Documentação de ajuda</h2>

    <h3>O que é?</h3>
    <p>O Publicador de Portarias é um software simples para automatizar, como o nome sugere, a publicação de portarias no Sistema de Gestão de Pessoas do Governo Federal (SIGEPE).</p>

    <h3>Como funciona?</h3>
    <p>A cada vez que é executado, o Publicador de Portarias carrega os valores pré-definidos pelo usuário no arquivo config.json e lê uma lista de arquivos que estejam localizados em um diretório do sistema informado pelo usuário. Em cada arquivo, o Publicador busca as informações necessárias para a publicação (número da portaria, texto, SIAPE do interessado etc) a partir de delimitadores informados também pelo usuário. Com essas informações, realiza as publicações no módulo Publicação do SIGEPE.</p>

    <h3>Como configurar?</h3>
    <P>Toda a configuração é feita no arquivo config.json, conforme os seguintes parâmetros:</P>

    <h4 class="chave-principal">config:</h4>
    <p>A chave config é utilizada para informar alguns parâmetros iniciais necessários para o funcionamento da aplicação.</p>

        <dt class="chave">"diretorio_arquivos:"</dt>
        <dd class="instrucao-chave">Informar o diretório completo (caminho do sistema) onde os arquivos das portarias estão localizados.<br>
        <span class="exemplo">"C:\\\\Usuários\\Fulano\\Portarias_Para_Publicar\\"</span></dd>
        <span class="alerta">Caso o diretório tenha contrabarras <code>\</code>, como no Windows, eles devem ser dobradas. Ex.: o diretório </em>C:\\Usuário\Documentos</em> deverá ser informado como <em>C:\\\\Usuário\\Documentos</em></span>
        <dt class="chave">"habilitacao_sigepe:"</dt>
        <dd class="instrucao-chave">Escrever o nome da habilitação do usuário no SIGEPE em que o módulo Publicação está ativado. Deve ser escrito <strong>exatamente</strong> como aparece para o usuário no SIGEPE.<br>
            <span class="exemplo">"GESTOR - ÓRGÃO: UFES"</span></dd>
        <dt class="chave">"adicionar_termo_nome_arquivo:"</dt>
        <dd class="instrucao-chave">Caso queira renomear o arquivo da portaria ao publicar para adicionar um termo após um nome atual, inserir esse termo nessa chave.
        <br><span class="exemplo">"publicado"</span></dd>
        <dt class="chave">"copiar_mover_arquivo_diretorio:"</dt>
        <dd class="instrucao-chave">Caso queira mover o arquivo da portaria para um novo diretório após a publicação, informar o diretório completo (caminho do sistema) de destino. Essa chave aceita, em qualquer ponto do diretório, a variável <code>[hoje, separador]</code> para preencher a data de hoje nesse ponto do diretório com o separador indicado. Caso hoje seja, 31/01/2022, o termo <code>[hoje, -]</code> será substituído por 31-01-2022. Além do hífen (-), podem ser usados os separadores barra (/) e ponto (.). <br>
            <span class="exemplo">"C:\\\\Usuários\\Fulano\\Portarias_Para_Publicar\\[hoje,-]"</span></dd>
        </dd>
    
    <h4 class="chave-principal">valores:</h4>
    <p>Nessa área, devem ser informados os valores que serão preenchidos no SIGEPE para todas as portarias a serem publicadas na execução do programa. Os demais valores, que mudam de portaria para portaria (como número, interessado, texto) são obtidos no próprio texto da portaria.</p>
        <dt class="chave">"edicao_bgp:"</dt>
        <dd class="instrucao-chave">Informar <code>Normal</code> ou <code>Extraordinário</code>, que são as duas opções no SIGEPE</dd>
        <dt class="chave">"tipo_assinatura:"</dt>
        <dd class="instrucao-chave">Informar <code>Manual</code> ou <code>Automático</code>, que são as duas opções no SIGEPE</dd>
        <dt class="chave">"especie:"</dt>
        <dd class="instrucao-chave">Informar a espécie de documento, conforme as opções do Sigepe. Importante: embora possa funcionar com outros tipos, o software foi concebido para lidar com a espécie <code>Portaria</code></dd>
        <dt class="chave">"tipo_preenchimento:"</dt>
        <dd class="instrucao-chave">Informar <code>Automático</code>, <code>Manual</code> ou <code>Sem número</code>, que são as três opções no SIGEPE</dd>
        <dt class="chave">"data_assinatura:"</dt>
        <dd class="instrucao-chave">Informar no formato DD/MM/AAAA ou informar <code>[hoje]</code> para preencher automaticamente com a data de hoje
            <span class="exemplo">"[hoje]" ou "27/05/2022"</span></dd>
        <dt class="chave">"data_publicacao:"</dt>
        <dd class="instrucao-chave">Informar no formato DD/MM/AAAA ou informar <code>[amanha]</code> para preencher automaticamente com o dia útil seguinte
            <span class="exemplo">"[amanha]" ou "01/07/2022"</span></dd>
        <dt class="chave">"orgao:"</dt>
        <dd class="instrucao-chave">Informar o código ou nome do seu órgão da forma como aparece no campo respectivo no SIGEPE.
            <span class="exemplo">"26234" ou "26234 - UNIVERSIDADE FEDERAL DO ESPÍRITO SANTO"</span></dd>
        <dt class="chave">"upag:"</dt>
        <dd class="instrucao-chave">Informar o código ou nome da UPAG da forma como aparece no campo respectivo no SIGEPE.
            <span class="exemplo">"1202" ou "1202 - DIRETORIA DE GESTÃO DE PESSOAS"</span></dd>
        <dt class="chave">"uorg:"</dt>
        <dd class="instrucao-chave">Informar o código ou nome da UORG da forma como aparece no campo respectivo no SIGEPE.
            <span class="exemplo">"743" ou "743 - PROGEP PRO-REITORIA DE GESTAO DE PESSOAS"</span></dd>
        <dt class="chave">"responsavel_assinatura:"</dt>
        <dd class="instrucao-chave">Informar o nome da autoridade que assina a portaria</dd>
        <dt class="chave">"cargo_responsavel:"</dt>
        <dd class="instrucao-chave">Informar o cargo/função da autoridade que assina a portaria</dd>

    <h4 class="chave-principal">temas_assuntos:</h4>
    <p>Nessa chave, você deve informar os temas das portarias que serão publicadas com o Publicador, relacionando-os com um termo do texto da portaria que será utilizado para identificar o tema e, ainda, o nível do assunto na tabela do SIGEPE. O modelo pode ser replicado quantas vezes forem necessárias para suprir todos os assuntos relacionados às portarias a serem publicadas.</p>
        <dt class="chave">"termo_portaria:"</dt>
        <dd class="instrucao-chave">Uma palavra ou expressão que será buscada no texto da portaria e relacionada com um determinado assunto no SIGEPE.</dd>
        <span class="alerta">Os termos informados são case-sensitive, ou seja, diferenciam maiúsculas e minúsculas. Isso significa que "Progressão" é diferente de "progressão" ao buscar o termo no texto da portaria. Caso seja necessário, é possível cadastrar as duas formas de escrita, repetindo as demais informações.</span>
        <dt class="chave">"tema_bgp:"</dt>
        <dd class="instrucao-chave">O tema do SIGEPE que é correspondente ao termo encontrado na portaria. Você deve, portanto, abrir o SIGEPE, procurar pelo tema a ser cadastrado ao encontrar o "termo_portaria" no texto da portaria, e informá-lo exatamente como aparece no SIGEPE.
            <img src="https://i.imgur.com/KQc9lAC.png">
        </dd>
        <dt class="chave">"nivel_assunto_bgp:"</dt>
        <dd class="instrucao-chave">O nível do assunto na árvore exibida pelo SIGEPE para cada assunto. Cada zero corresponde a um nível e cada nível posterior deve ser antecedido por um underline _. Por exemplo, caso o assunto na árvore do SIGEPE esteja no quarto nível, o que deve ser informado no nível_assunto_bgp é: "0_0_0_0"
            <img width="50%" src="https://i.imgur.com/TIVLO7x.png">
            No exemplo acima, para selecionar o assunto "020 - PESSOAL" deve-se informar "0" nessa chave; para o assunto "023 - QUADROS, TABELAS E POLÍTICAS DE PESSOAL", deve-se informar "0_0"; ou para o assunto "023.03 - REESTRUTURAÇÕES E ALT[...]", informar o nível "0_0_0". Se houvesse outros níveis, a lógica seguiria a mesma, acrescentando um "_0" para cada nível seguinte.
        </dd>
        <dt class="chave">"arrow_down:"</dt>
        <dd class="instrucao-chave">Em alguns casos, ao buscar um tema, o SIGEPE possui dois temas com o mesmo nome. Por padrão, o Publicador de Portarias selecionará o primeiro da lista, mas caso seja necessário escolher algum abaixo dele, deve-se informar aqui quantos níveis o Publicador deve descer para encontrar o tema correto. Por exemplo, o tema "Admissão" aparece duas vezes na lista de temas do SIGEPE: para selecionar a primeira, o arrow_down deve ser "0", e para selecionar o segundo, o arrow_down deve ser "1". Por padrão, deve-se manter o valor "0" (zero).
            <img src="https://i.imgur.com/3qOcG1P.png">
            Na imagem acima, ao informar "0" (zero) na chave "arrow_down", o Publicador selecionará o primeiro "Admissão", e ao informar "1" (um), o Publicador descerá um nível (apertará a seta para baixo uma vez) e selecionará o segundo "Admissão".</dd>

    <p><strong>Exemplo:</strong></p>
    <p>Ao preencher os seguintes valores:</p>
        <ul>
            <li>"termo_portaria": "Progressão"</li>
            <li>"tema_bgp": "Ascensão e progressão funcional"</li>
            <li>"nivel_assunto_bgp": "0_0_0"</li>
            <li>"arrow_down": "0"</li>
        </ul>
    <p>Caso o Publicador encontre o termo "Progressão" na portaria, publicará a portaria com o tema "Ascensão e progressão funcional" e o assunto do terceiro nível da lista de assuntos (que é "Reestruturações e alterações salariais..."). Como o arrow_down é 0 (zero), o Publicador selecionará o primeiro resultado "Ascensão e progressão funcional" na lista de temas.</p>

        <h4 class="chave-principal">temas_assuntos:</h4>
        <p>Nessa chave, você dirá ao Publicador entre quais termos estão os valores que precisam ser buscados no texto da Portaria. Por exemplo, se a matrícula SIAPE está entre as expressões "Matrícula SIAPE nº." e ",", esses dois valores deverão ser informados na chave "siape". O mesmo para os demais valores.</p>
        
        <dt class="chave">"numero_portaria:"</dt>
        <dd class="instrucao-chave">["valor antes do número da portaria no texto", "valor depois do número"]</dd>
        <dt class="chave">"siape:"</dt>
        <dd class="instrucao-chave">["valor antes do número do SIAPE no texto", "valor depois do número"]</dd>
        <dt class="chave">"cabecalho:"</dt>
        <dd class="instrucao-chave">["valor antes do cabeçalho no texto", "valor depois do cabeçalho"] (por cabeçalho, entende-se o trecho "Portaria nº. XXXX de XX de XX de XXXX". IMPORTANTE: caso o limite do cabeçalho seja o ano da data de assinatura (o que geralmente ocorre), você pode informar o valor "var_ano_assinatura" e o sistema verificará o ano automaticamente</dd>
        <dt class="chave">"preliminar_portaria:"</dt>
        <dd class="instrucao-chave">["valor antes do texto preliminar da portaria", "valor depois do texto"] (por texto preliminar, entende-se a parte inicial "O Reitor da Universidade...... RESOLVE:")</dd>


    <h3>Limitações</h3>
    <ul>
        <li>Os arquivos das portarias devem estar no formato RTF (Rich Text)</li>
        <li>No momento, o Publicador só lida bem com portarias de duas partes (parte preliminar e parte principal única, sem quebra de linha nessa segunda parte). Planeja-se corrigir essa limitação em breve.</li>
    </ul>

    <footer>
    <p>Em caso de dúvidas, entre em contato: <a href="mailto:cegasparjr@gmail.com">cegasparjr@gmail.com</a> ou <a href="https://github.com/cegj">github.com/cegj</a></p>
    <p>Desenvolvido por Carlos E. Gaspar Jr. Sinta-se livre para modificar o código. Pull requests no GitHub são bem-vindos.</p>
    </footer>
    </body>

    </html>